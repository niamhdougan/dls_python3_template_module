include:
  - project: 'controls/reports/ci_templates'
    ref: 0-14
    file: 'common_variables.yml'

tags:
  - niamh

install_packages:
  script:
    - pipenv install --dev

unit_tests_and_coverage:
  coverage: '/TOTAL.*\s+(\d+\%)/'
  script:
    - pipenv run tests

build_docs:
  script:
    - pipenv run docs
    - mkdir -p ${DOCS_PUBLISH_ROOT}/latest
    - cp -rf build/html/* ${DOCS_PUBLISH_ROOT}/latest

wheel_and_metadata_check:
  script:
    - dls-python3 setup.py bdist_wheel
    - dls-py3 check --no-tag-check
